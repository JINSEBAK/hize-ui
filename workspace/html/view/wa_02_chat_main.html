<!DOCTYPE html>
<html lang="ko">
    <head>
        @@include('../common/resources.html', { "type" : "admin" })
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">
    </head>
    <body>

        <!-- header -->
        @@include('../common/header.html', { "active" : "활성화되어야하는 메뉴" })
       
        <div class="container-fluid">
            <div class="row">

                <!-- gnb -->
                @@include('../common/navigation.html')

                <!-- contents -->
                <div class="main" id="main">
                    @@include('../common/title.html', { "title" : "채팅 <span class='glyphicon glyphicon-info-sign'></span>", "sub" : "참여중인 채팅리스트를 관리하고 채팅을 할 수 있습니다." })

                    <div class="contents chat-contents">
                        <div class="col-md-12">
                            <button type="button" class="btn btn-secondary pull-right">단체 메시지 발송</button>
                        </div>
                        <div class="col-md-8">
                            <div class="chat">
                                <div class="chat-header">
                                    <span class="title">[유료] 성투 주식방 1</span>
                                    <span class="count">85/120</span>
                                    <div class="pull-right">
                                        <button type="button" class="btn btn-default btn-sm">신호발송</button>
                                        <button type="button" class="btn btn-default btn-sm">
                                            <span class="glyphicon glyphicon-search"></span>
                                        </button>
                                        <div class="btn-group">
                                            <button type="button" class="btn" data-toggle="dropdown" aria-expanded="false">
                                                <span class="glyphicon glyphicon-menu-hamburger"></span>
                                            </button>
                                            <ul class="dropdown-menu dropdown-menu-right chat-sub-menu" role="menu">
                                                <li>
                                                    <a href="#" data-toggle="modal" data-target="#modalNoticeList">
                                                        <span class="glyphicon glyphicon-bullhorn"></span>
                                                        공지사항
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#" data-toggle="modal" data-target="#modalMemberList">
                                                        <span class="glyphicon glyphicon-user"></span>
                                                        회원목록
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#">
                                                        <span class="glyphicon glyphicon-signal"></span>
                                                        신호내역
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#">
                                                        <span class="glyphicon glyphicon-th"></span>
                                                        보유전광판
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#" data-toggle="modal" data-target="#modalChatSettings">
                                                        <span class="glyphicon glyphicon-cog"></span>
                                                        채팅방 설정 
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#" data-toggle="modal" data-target="#modalCertification">
                                                        <span class="glyphicon glyphicon-lock"></span>
                                                        인증번호 설정
                                                    </a>
                                                </li>
                                                <li class="divider"></li>
                                                <li>
                                                    <a href="#" id="chatLogout">
                                                        <span class="glyphicon glyphicon-log-out"></span>
                                                        나가기
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <!-- fixed notice -->
                                    <div class="chat-notice">
                                        <a href="#" data-toggle="modal" data-target="#modalNoticeModify">성투주식방 공지</a>
                                    </div>
                                </div>
                                <div class="chat-body">
                                    <div class="scroll" >
                                        <div class="inner" id="chatBody">
                                            <div class="date">2021년 4월 10일</div>

                                            <!-- 
                                                .msg: 공통
                                                .general: 일반사용자 (왼쪽위치)
                                                .admin: 관리자(말풍선 컬러 다름)
                                                .my: 나 (오른쪽 위치)
                                                .signal: 신호메시지
                                            -->
                                            <div class="msg general">
                                                <div class="img" data-toggle="popover" data-placement="right" title="나회원"
                                                data-html="true" data-content='가입기간: 2021.03.01 ~ 2021.05.20<br>가입비: 100만원 <button class="btn btn-secondary btn-sm">블락해제</button>'>
                                                    <img src="../../assets/images/photos/user-img-default.png">
                                                </div>
                                                <div class="info">
                                                    <span class="name" >나회원</span>
                                                    <span class="id">(namem79)</span>
                                                    <span class="time">오전 10:00</span>
                                                    <div class="balloon">
                                                        <div class="inner">오늘도 성투하세요.</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="msg general blocked">
                                                <div class="img" data-toggle="popover" data-placement="right" title="김수로"
                                                data-html="true" data-content='가입기간: 2021.03.01 ~ 2021.05.20<br>가입비: 100만원 <button class="btn btn-secondary btn-sm">블락해제</button>'>
                                                    <img src="../../assets/images/photos/user-img-default.png">
                                                </div>
                                                <div class="info">
                                                    <span class="name">김수로</span>
                                                    <span class="id">(surokim)</span>
                                                    <span class="time">오전 10:00</span>
                                                    <div class="balloon">
                                                        <div class="inner" id="delExample">여러분도 1**!</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="msg my">
                                                <div class="info">
                                                    <span class="time">오전 10:00</span>
                                                    <div class="balloon">
                                                        <div class="inner">분석을 통해 실시간 종목을 추천합니다. 오늘도 성공투자!</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 신호메시지 -->
                                            <div class="msg my signal">
                                                <div class="info">
                                                    <div class="time">오전 10:00</div>
                                                    <div class="balloon">
                                                        <div class="inner">
                                                            <div style="color: red; font-weight: bold;">[매수] 신호입니다.</div>
                                                            ❖ 삼성전자 (005930) ❖<br><br>
                                                            ►매수가 : 85.000원 이하<br>
                                                            비중 : 10%<br>
                                                            익/손절가 : 실시간 제시<br><br>
                                                            삼성전자 현구간 2차 매수 진행합니다.<br>
                                                            의도적인 흔들기!! 비중확보 후 추가대응 통해 빠른 익절 진행하겠습니다.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="msg my signal">
                                                <div class="info">
                                                    <div class="time">오전 10:00</div>
                                                    <div class="balloon">
                                                        <div class="inner">
                                                            <div style="color: red; font-weight: bold;">[매수] 신호입니다.</div>
                                                            ❖ 삼성전자 (005930) ❖<br><br>
                                                            ►매수가 : 85.000원 이하<br>
                                                            비중 : 10%<br>
                                                            익/손절가 : 실시간 제시<br><br>
                                                            삼성전자 현구간 2차 매수 진행합니다.<br>
                                                            의도적인 흔들기!! 비중확보 후 추가대응 통해 빠른 익절 진행하겠습니다.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 블록 회원에 대한 답장 -->
                                            <div class="msg my">
                                                <div class="info">
                                                    <div class="time">오전 10:10</div>
                                                    <div class="balloon">
                                                        <div class="inner">
                                                            <p class="rp-msg">
                                                                <strong>주식수로왕(surokim)</strong>에게 답장<br>
                                                                여러분도 1**!
                                                            </p>
                                                            <p class="rp-msg">
                                                                채팅방에서 가쉽에 대한 글은 올리지 말아주세요.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-input">
                                        <div class="pod-options">
                                            <ul>
                                                <li>
                                                    <div class="btn-group dropup">
                                                        <button type="button" class="btn btn-default" data-toggle="dropdown" aria-expanded="false">
                                                            <span class="glyphicon glyphicon-music"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" role="menu">
                                                            <li>
                                                                <ul class="emoji-list">
                                                                    <li><span class="glyphicon glyphicon-heart"></span></li>
                                                                    <li><span class="glyphicon glyphicon-star"></span></li>
                                                                    <li><span class="glyphicon glyphicon-star-empty"></span></li>
                                                                    <li><span class="glyphicon glyphicon-apple"></span></li>
                                                                    <li><span class="glyphicon glyphicon-heart"></span></li>
                                                                    <li><span class="glyphicon glyphicon-star"></span></li>
                                                                    <li><span class="glyphicon glyphicon-star-empty"></span></li>
                                                                    <li><span class="glyphicon glyphicon-apple"></span></li>
                                                                    <li><span class="glyphicon glyphicon-heart"></span></li>
                                                                    <li><span class="glyphicon glyphicon-star"></span></li>
                                                                    <li><span class="glyphicon glyphicon-star-empty"></span></li>
                                                                    <li><span class="glyphicon glyphicon-apple"></span></li>
                                                                    <li><span class="glyphicon glyphicon-heart"></span></li>
                                                                    <li><span class="glyphicon glyphicon-star"></span></li>
                                                                    <li><span class="glyphicon glyphicon-star-empty"></span></li>
                                                                    <li><span class="glyphicon glyphicon-apple"></span></li>
                                                                </ul>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </li>
                                                <li>
                                                    <button class="btn btn-default btn-file">
                                                        <label>
                                                            <span class="glyphicon glyphicon-picture" for="chatImageFile"></span>
                                                            <input type="file" id="chatImageFile">
                                                        </label>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button" class="btn btn-primary">전송</button>
                                                </li>
                                                <li>
                                                    <button type="button" class="btn btn-default btn-setting" data-toggle="popover">
                                                        <span class="glyphicon glyphicon-cog"></span>
                                                    </button>
                                                    <div id="chatSetting" class="hide">
                                                        <form id="settingInPopover">
                                                            <div class="form-title">
                                                                메세지 입력 기능
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="radio-inline">
                                                                    <input type="radio" name="chat-freeze" value="0" onchange="javascript: messageSend('off');"> OFF 
                                                                </label> 
                                                                <label class="radio-inline">
                                                                    <input type="radio" name="chat-freeze" value="1" checked onchange="javascript: messageSend('on');"> ON
                                                                </label>
                                                            </div>
                                                            <div class="form-title">
                                                                파일 첨부 기능
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="radio-inline">
                                                                    <input type="radio" name="attachment" value="0" checked onchange="javascript: fileSend('off');"> OFF 
                                                                </label> 
                                                                <label class="radio-inline">
                                                                    <input type="radio" name="attachment" value="1" onchange="javascript: fileSend('on');"> ON
                                                                </label>
                                                            </div>
                                                            <button type="button" class="btn btn-primary">저장</button>
                                                        </form>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>

                                        <!-- 답장하기 UI : 블락회원의 메세지의 답장하기 선택 시 노출 -->
                                        <div class="block-msg-reply">
                                            <!-- target 정보 -->
                                            <div class="tg-info">
                                                <span class="glyphicon glyphicon-thumbs-down"></span>
                                                <span class="tg-name">
                                                    <strong>주식수로왕(surokim)</strong>에게 답장
                                                </span>
                                                <span class="tg-msg">여러분도 1**!</span>
                                            </div>
                                            <span class="glyphicon glyphicon-remove btn-reply-cancel"></span>
                                        </div>

                                        <textarea class="form-control" rows="2" placeholder="메시지를 입력하세요." id="chatMsg"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <!-- tabs -->
                            <div>
                                <ul class="nav nav-tabs nav-justified">
                                    <li role="presentation" class="active"><a href="#allChatList" data-toggle="tab">관리 채팅방</a></li>
                                    <li role="presentation"><a href="#myChatList" data-toggle="tab">참여 채팅방</a></li>
                                </ul>
                            </div>
                            <div class="tab-content scroll">
                                <div class="tab-pane fade in active" id="allChatList">
                                    <form>
                                        <div class="form-group form-search">
                                            <label for="keywordAll" class="sr-only">검색</label>
                                            <input type="text" class="form-control" placeholder="채팅방명" id="keywordAll">
                                            <span class="glyphicon glyphicon-search"></span>
                                        </div>
                                    </form>
                                    <div class="filter list-filter">
                                        <div class="btn-group pull-right">
                                            <button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
                                                전체 <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu" role="menu">
                                                <li><a href="#">유료</a></li>
                                                <li><a href="#">무료</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="chat-list">
                                        <div class="panel panel-default chat-card active">
                                            <div class="panel-body">
                                                <div class="chat-info">
                                                    <div class="img-thumb">
                                                        <img src="../../assets/images/photos/sample.jpeg" alt="채팅방 설정 이미지" >
                                                    </div>
                                                    <div class="infos">
                                                        <div class="title">
                                                            <span class="label label-warning">유료</span>
                                                            <span class="tt">성투 주식방 1</span>
                                                            <div class="desc">나 주식은 당신들의 재산을 많이 많이 불려줄 생각입니다. 나만 믿고 따라와봥</div>
                                                        </div>
                                                        <div class="count">
                                                            85/120
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-thumb">
                                                    <span>감사합니다. 감사합니다. 감사합니다.감사합니다.감사합니다.감사합니다.감사합니다. 감사합니다.감사합니다.감사합니다.감사합니다.감사합니다.감사합니다.감사합니다.감사합니다.감사합니다.</span>
                                                    <span class="date">오후 4:20</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel panel-default chat-card">
                                            <div class="panel-body">
                                                <div class="chat-info">
                                                    <div class="img-thumb">
                                                        <img src="../../assets/images/photos/sample.jpeg" alt="채팅방 설정 이미지">
                                                    </div>
                                                    <div class="infos">
                                                        <div class="title">
                                                            <span class="label label-warning">유료</span>
                                                            <span class="tt">성투 주식방 2</span>
                                                            <div class="desc">나 주식은 당신들의 재산을 많이 많이 불려줄 생각입니다. 나만 믿고 따라와봥</div>
                                                        </div>
                                                        <div class="count">
                                                            70/120
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-thumb">
                                                    <span>신호발송</span>
                                                    <span class="date">오후 3:00</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel panel-default chat-card">
                                            <div class="panel-body">
                                                <div class="chat-info">
                                                    <div class="img-thumb">
                                                        <img src="../../assets/images/photos/sample.jpeg" alt="채팅방 설정 이미지">
                                                    </div>
                                                    <div class="infos">
                                                        <div class="title">
                                                            <span class="tt">모두에게 공유하는 성투주식방입니다 컴온캄온콤온!</span>
                                                            <div class="desc">나 주식은 당신들의 재산을 많이 많이 불려줄 생각입니다. 나만 믿고 따라와봥</div>
                                                        </div>
                                                        <div class="count">
                                                            56/100
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-thumb">
                                                    <span>오늘 상승률 100%입니다!</span>
                                                    <span class="date">4월 10일</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel panel-default chat-card">
                                            <div class="panel-body">
                                                <div class="chat-info">
                                                    <div class="img-thumb">
                                                        <img src="../../assets/images/photos/sample.jpeg" alt="채팅방 설정 이미지">
                                                    </div>
                                                    <div class="infos">
                                                        <div class="title">
                                                            <span class="label label-warning">유료</span>
                                                            <span class="tt">성투 주식방 3</span>
                                                            <div class="desc">나 주식은 당신들의 재산을 많이 많이 불려줄 생각입니다. 나만 믿고 따라와봥</div>
                                                        </div>
                                                        <div class="count">
                                                            75/80
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-thumb">
                                                    <span>감사합니다.</span>
                                                    <span class="date">4월 9일</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel panel-default chat-card">
                                            <div class="panel-body">
                                                <div class="chat-info">
                                                    <div class="img-thumb">
                                                        <img src="../../assets/images/photos/sample.jpeg" alt="채팅방 설정 이미지">
                                                    </div>
                                                    <div class="infos">
                                                        <div class="title">
                                                            <span class="label label-warning">유료</span>
                                                            <span class="tt">성투 주식방 4</span>
                                                            <div class="desc">나 주식은 당신들의 재산을 많이 많이 불려줄 생각입니다. 나만 믿고 따라와봥</div>
                                                        </div>
                                                        <div class="count">
                                                            75/80
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-thumb">
                                                    <span>ㅋㅋㅋㅋㅋㅋ</span>
                                                    <span class="date">4월 8일</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div> <!-- 전체 채팅방 -->

                                <!-- 참여 채팅방 -->
                                <div class="tab-pane fade" id="myChatList">
                                    <form>
                                        <div class="form-group form-search">
                                            <label for="keywordMy" class="sr-only">검색</label>
                                            <input type="text" class="form-control" placeholder="채팅방명" id="keywordMy">
                                            <span class="glyphicon glyphicon-search"></span>
                                        </div>
                                    </form>

                                    <!-- 목록이 1개 이상 존재할 경우에만 filter 노출 -->
                                    <div class="filter list-filter" style="display: none;">
                                        <div class="btn-group pull-right">
                                            <button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown"
                                                aria-expanded="false">
                                                전체 <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu" role="menu">
                                                <li><a href="#">유료</a></li>
                                                <li><a href="#">무료</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="chat-list">
                                        <div class="no-result">
                                            <span class="glyphicon glyphicon-warning-sign"></span>
                                            참여하는 채팅방이 없습니다.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 팝업 -->
        @@include('./inside/wa_02_chat_main_popup.html')

        <!-- 채팅방 설정 팝업-->
        @@include('./inside/wa_02_chat_main_setting.html')


        <!-- scripts -->
        @@include('../common/scripts.html')
        <script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>
        <script>
            $(function() {
                var divHeight = '';
                var browserHeight = document.documentElement.clientHeight;
                divHeight = browserHeight - (70 + 49 + 82 + 42 + 12);

                $('.chat-contents').find('.tab-content').css('height', divHeight+'px');
                $('.chat-body').find('.scroll').css('height', divHeight-78+'px');

                $('.chat-body').find('.scroll').scrollTop(divHeight);

                $('#chatMsg').keydown(function(event) {
                    event.preventDefault;
                    var code = event.keyCode ? event.keyCode : event.which;

                    if ( code === 13 ) {
                        if ( event.shiftKey === true ) {
                            // 새로운 라인 입력
                        } else {
                            sendMessage();
                            return false;
                        }
                    }
                });

                 // 사용자 정보
                 $('.msg .img').popover();

                // 말풍선 클릭
                $('.msg.general').find('.balloon').on('click', function() {
                    if ( $(this).hasClass('selected') ) {
                        // $(this).removeClass('selected');
                        // $(this).find('.btn-delete').remove();
                    } else if ( $(this).hasClass('del')) {
                        return false;
                    } else {
                        const _html = '<button type="button" class="btn-sm btn-reply" onClick="replyMsg()">'
                                    +   '<span class="glyphicon glyphicon-retweet"></span>'
                                    +'</button>'
                                    +'<button type="button" class="btn-sm btn-delete" onClick="removeMsg(this);">'
                                    +   '<span class="glyphicon glyphicon-remove"></span>'
                                    +'</button>';

                        $(this).addClass('selected');
                        $(this).append(_html);
                    }
                });

                // 설정 버튼 클릭
                $('.btn-setting').popover({
                    title: '<span>사용자앱 메세지 기능 설정</span>',
                    container: 'body',
                    placement: 'top',
                    html: true,
                    content: function() {
                        return $('#chatSetting').html();
                    }
                });

                // 공지사항 입력
                $('#noticeContent').on('change keyup paste', function() {
                    var len = $(this).val().length;
                    if ( len <= 100 ) {
                        $(this).next('.count').find('.txt-length').html(len);
                    } else {
                        callAlert({ title: '입력 불가', description: '공지사항은 100자까지 등록 가능합니다.'})
                    }
                    $(this).val( $(this).val().substring(0, 100) );
                });

                $('#noticeDetailContent').on('change keyup paste', function() {
                    var len = $(this).val().length;
                    if ( len <= 500 ) {
                        $(this).next('.count').find('.txt-length').html(len);
                    } else {
                        callAlert({ title: '입력 불가', description: '공지사항은 100자까지 등록 가능합니다.'})
                    }
                    $(this).val( $(this).val().substring(0, 500) );
                });

                // 공지사항 상세
                $('.notice-list').find('.notice').on('click', function() {
                    $('#modalNoticeModify .count').find('.txt-length').text( $('#modalNoticeModify').find('textarea').val().length );
                    // 열려있는 팝업 닫기
                    $('.modal').modal('hide');
                    $('#modalNoticeModify').modal('show');
                });

                //
                $('#modalNoticeModify').find('.btn-default').on('click', function() {
                    // 삭제 확인
                    callConfirm({ title: '공지사항을<br>삭제하시겠습니까?' }, onClickDelete());
                });
                $('#modalNoticeModify').find('.btn-primary').on('click', function() {
                    // 수정 알림
                    callAlert({ title: '공지사항이<br>수정되었습니다.'})
                });

                // datepicker 설정
                $('.datepicker').datepicker({
                    dateFormat: 'yyyy.mm.dd'
                });

                // timepicker 설정
                $('.timepicker').timepicker();

                // 답장취소
                $('.btn-reply-cancel').on('click', function() {
                    $('.block-msg-reply').fadeOut('fast');
                });

                // 회원 상태 변경
                $('#modalMemberList').find('.btn').on('click', function() {
                    var type = $(this).text();
                    callConfirm({
                        title: '회원을 블락' + type.split('블락')[1] + '<br>하시겠습니까?'
                    });
                });

                // 회원 선택 및 강퇴 버튼 활성화
                $('input[name=user-chk]').on('change', function() {
                    var checkedCount = document.querySelectorAll('input[name=user-chk]:checked').length;
                    if ( checkedCount > 0 ) {
                        $('#btnExorcise').removeAttr('disabled');
                    } else {
                        $('#btnExorcise').attr('disabled', true);
                    }
                });

                $('#btnExorcise').on('click', function() {
                    callConfirm({
                        title: "회원을 채팅방에서<br>강퇴하시겠습니까?"
                    })
                });

                // 채팅방 나가기
                $('#chatLogout').on('click', function() {
                    event.preventDefault();

                    callConfirm({
                        title : "채팅방에서 나가시겠습니까?",
                        description: "채팅방에서 나가는 경우<br>대화내용이 모두 삭제되고<br>채팅목록에서도 삭제됩니다."
                    });
                });

                // 인증번호 설정
                $('input[name=certify-num]').change(function() {
                    var type = $(this).val();
                    if ( type === '1' ) {
                        $('#inputCertificationNum').removeAttr('disabled');
                    } else {
                        $('#inputCertificationNum').attr('disabled', true);
                    }
                });

        

            });

            function sendMessage() {
                var txt = $('#chatMsg').val();
                var _html = '<div class="msg my">'
                        +       '<div class="info">'
                        +           '<span class="time">' + getChatDate() + '</span>'
                        +           '<div class="balloon">'
                        +               '<div class="inner">' + txt.replace(/\n/g, '<br>') + '</div>'
                        +           '</div>'
                        +       '</div>'
                        + '</div>';

                $('#chatBody').append(_html);
                $('.chat-body').find('.scroll').scrollTop( $('#chatBody').innerHeight() );

                // textarea 초기화
                $('#chatMsg').val('');
            }

            // 메세지 삭제하기 
            function removeMsg(obj) {
                event.preventDefault(); // 이벤트 버블링 방지 

                callConfirm({ title: "메세지를 삭제하시겠습니까?", description: "삭제된 메세지는 복원을 할 수 없습니다."}, exampleRemoveMsg );
                //$(obj).parents('.msg').remove();
            }
            var exampleRemoveMsg = function() {
                // 개발 시에는 선택된 메시지id or 유니크한 값으로 참조해서 실행할 것
                $('#delExample').text("삭제된 메세지입니다.").parent('.balloon').addClass('del');
                // 
                $('#delExample').parent('.balloon').removeClass('selected');
            }

            // 메세지 답장하기 - ux만 확인
            function replyMsg() {
                event.preventDefault();
                event.stopPropagation();

                $('.balloon').removeClass('selected');
                $('.block-msg-reply').fadeIn('fast');
            }



            // 설정 - 팝오버 동적 요소에 이벤트 바인딩이 안됨. 개발시 분리할 것
            function messageSend(mode) {
                if ( mode === 'off' ) {
                    $('.chat-body').find('.scroll').addClass('freezing');
                    $('.chat-input').find('.form-control').attr('disabled', true);  // form 요소 disabled
                    $('.pod-options').find('button').attr('disabled', true);    // button disabled
                } else {
                    $('.chat-body').find('.scroll').removeClass('freezing');
                    $('.chat-input').find('.form-control').removeAttr('disabled'); 
                    $('.pod-options').find('button').removeAttr('disabled');
                }
            }

            function fileSend(mode) {
                if ( mode === 'off') {
                    $('.btn-file').attr('disabled', true);
                } else {
                    $('.btn-file').removeAttr('disabled');
                   
                }
            }

            function onClickDelete() {
                $('.modal').modal('hide');
            }

            function setAlarmProtect(mode) {
                if ( mode === 'off' ) {
                    $('.timepicker').attr('disabled', true);
                } else {
                    $('.timepicker').removeAttr('disabled');
                }
            }

        </script>
    </body>
</html>